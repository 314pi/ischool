FILE(GLOB ischool_INCLUDES ${CMAKE_CURRENT_SOURCE_DIR}/src/*.h)
FILE(GLOB ischool_SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/src/*.cpp)
FILE(GLOB ischool_UI ${CMAKE_CURRENT_SOURCE_DIR}/dialogs/*.ui)
SET(QRC_FILE ${CMAKE_CURRENT_SOURCE_DIR}/ischool.qrc)
QT4_WRAP_CPP(ischool_MOC_out ${ischool_INCLUDES})
QT4_WRAP_UI(ischool_UIC_out ${ischool_UI})
QT4_ADD_RESOURCES(ischool_RCC_out ${QRC_FILE})
QT4_TRANSLATIONS_FOR_QRC(${QRC_FILE} ${ischool_SOURCES} ${ischool_INCLUDES})

IF(ISCHOOL_BUILD_WIN32)
	SET(WINRC "${CMAKE_CURRENT_BINARY_DIR}/ischoolrc.obj")
	ADD_CUSTOM_COMMAND(OUTPUT ${WINRC}
						COMMAND ${WINDRES}
							-I${CMAKE_CURRENT_SOURCE_DIR}
							-o${WINRC}
							-i${CMAKE_CURRENT_BINARY_DIR}/ischool.rc
						DEPENDS ${CMAKE_CURRENT_BINARY_DIR}/ischool.rc)

ENDIF(ISCHOOL_BUILD_WIN32)

INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR} ${CMAKE_CURRENT_SOURCE_DIR}/src)
ADD_EXECUTABLE(ischool ${ischool_UIC_out} ${ischool_SOURCES} ${ischool_INCLUDES} ${ischool_MOC_out} ${ischool_RCC_out} ${WINRC})
TARGET_LINK_LIBRARIES(ischool IschoolCore)

INSTALL(TARGETS ischool RUNTIME DESTINATION bin)

IF(ISCHOOL_BUILD_WIN32)
	SET_TARGET_PROPERTIES(ischool PROPERTIES LINK_FLAGS -mwindows)
ENDIF(ISCHOOL_BUILD_WIN32)

